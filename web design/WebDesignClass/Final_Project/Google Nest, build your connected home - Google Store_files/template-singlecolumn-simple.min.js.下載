(()=>{function ye(r,e){let t=Object.prototype.toString.call(r).slice(8,-1).toLowerCase();return e===t}function Ee(r){return ye(r,"boolean")}function st(r){return ye(r,"undefined")}function W(r){return!st(r)}function ve(){return Te()||Ie()}function Te(){return/iPhone|iPad|iPod/i.test(navigator.userAgent)||Se()}function Ie(){return/Android/i.test(navigator.userAgent)}function Se(){return navigator.userAgent.toLowerCase().indexOf("macintosh")!==-1&&Boolean(navigator.maxTouchPoints)&&navigator.maxTouchPoints>2}function Ae(r,e){let t=0,i=n=>{let s=window.innerWidth;(!ve()||t!==s)&&(r(n),t=s)};return window.addEventListener("resize",i,e),()=>{window.removeEventListener("resize",i)}}var C=class{constructor(){this.watcherConfigs=[]}add(e){Array.isArray(e.on)?e.on.forEach(i=>{let n=Object.assign({},e);n.on=i,this.addSingleEvent(n)}):this.addSingleEvent(e)}addSingleEvent(e){let t=i=>{e.runWhen?e.runWhen()&&e.callback(i):e.callback(i)};if(e.listener=t,e.on==="smartResize")e.remover=Ae(t,e.eventOptions||{});else if(e.on==="resize"&&e.element!==window){let i=new ResizeObserver(n=>{t(n)});i.observe(e.element),e.remover=()=>{i.unobserve(e.element)}}else if(e.on==="mutation"){let i=new MutationObserver(n=>{t(n)});i.observe(e.element,e.eventOptions),e.remover=()=>{i.disconnect()}}else e.element.addEventListener(e.on,t,e.eventOptions||{}),e.remover=()=>{e.element.removeEventListener(e.on,t,e.eventOptions||{})};this.watcherConfigs.push(e)}removeById(e){this.watcherConfigs=this.watcherConfigs.filter(t=>{if(t.id&&t.id===e){let i=t.remover;return i&&i(),!1}return t})}removeAll(){this.watcherConfigs.forEach(e=>{let t=e.remover;t&&t()}),this.watcherConfigs=[]}run(e){this.watcherConfigs.filter(i=>i.id&&i.id===e).forEach(i=>{i.callback()&&i.callback()})}dispose(){this.removeAll()}};function z(r){return r}function X(r){return Object.is(r,-0)?0:r}function y(r,e,t){return Math.min(Math.max(t,r),e)}function Q(r){return r*(Math.PI/180)}function L(r){return r*180/Math.PI}function Ce(r){return y(0,1,X(r))}function _e(r){return Ce(r)}function v(r,e,t){let i=_e(t);return(1-i)*r+i*e}function Me(r,e,t,i=!1){return i?(t-r)/(e-r):_e((t-r)/(e-r))}function ot(r,e,t,i=z){return t=i(t),v(r,e,t)}function J(r,e,t,i){return v(r,e,1-Math.exp(-t*i))}function R(r,e,t,i=z){return ot(r,e,t,i)}function T(r,e,t){let i=t-e;return e+((r-e)%i+i)%i}function De(r){return r.reduce((e,t)=>e+t,0)}var G=class{constructor(){this.resolve=()=>{},this.reject=()=>{},this.complete=!1,this.promise=new Promise((e,t)=>{this.resolve=i=>(this.complete=!0,e(i)),this.reject=i=>(this.complete=!0,t(i))})}getPromise(){return this.complete?new Promise(e=>{e()}):this.promise}};function oe(){return Date.now()}function Le(r,e){return e-r}function Re(r,e,t){let i;return function(...n){let s=this,a=()=>{i=void 0,r.apply(s,n)},o=()=>{i=void 0};t||(clearTimeout(i),i=+setTimeout(a,e)),t&&i===void 0&&(r.apply(s,n),i=+setTimeout(o,e))}}function Ne(r,e=0,t=100){let i=oe(),n,s,a=new Promise((l,c)=>{n=l,s=c}),o=()=>{let l=Le(i,oe());r()?n():e&&l>e?s("Wait until timed out"):setTimeout(o,t)};return o(),a}function Z(r){return!r.paused&&!r.ended&&r.readyState>2}function Oe(r,e=1e4){let t=[];return r.forEach(i=>{let n=new G;t.push(n.getPromise()),Ne(()=>i.readyState===4,e,10).then(()=>{n.resolve()})}),Promise.all(t)}function ae(r,e,t){let i=new CustomEvent(e,{detail:t});r.dispatchEvent(i)}function Pe(r){return window.getComputedStyle(r)}function at(r){return Array.from(r.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'))}function le(r,e){at(r).forEach(i=>{let n=i.tabIndex;i.hasAttribute("originalTabIndex")||i.setAttribute("originalTabIndex",n+""),i.tabIndex=e})}function ke(r){Array.from(r.querySelectorAll("[originalTabIndex]")).forEach(t=>{let i=t.getAttribute("originalTabIndex")||"";t.tabIndex=+i})}function lt(r){return window.getComputedStyle(r).display==="none"}function ce(r){return lt(r)?!0:r.parentElement?ce(r.parentElement):!1}function We(){return document.scrollingElement||document.documentElement}function ze(r){Array.from(r.querySelectorAll("[loading=lazy]")).forEach(t=>{t.removeAttribute("loading")})}var _=class{static inview(e,t={},i){let n=null,s=null,a=null,o=!1,l=new G,c=()=>({changes:n,lastChange:s,inview:a,ready:o}),d=x=>{x.length>=1&&(n=x,s=x.slice(-1)[0],a=s.isIntersecting,o=!0,l.resolve()),i&&i(e,x.slice(-1)[0],f)},h=window.location.search.split("evBypass=")[1];if(h=h&&h.split("&")[0],h==="true")return window.setTimeout(()=>{i&&i(e,{isIntersecting:!0,isVisible:!0},()=>{}),l.resolve()}),{observer:null,dispose:()=>{},state:()=>({ready:!0,inview:!0}),readyPromise:l.getPromise()};let f=()=>{u&&u.unobserve(e),u&&u.disconnect(),n=[],s=null},u=new IntersectionObserver(d,t);return u.observe(e),{observer:u,dispose:f,state:c,readyPromise:l.getPromise()}}};var Be={LOAD_START:"LOAD_START",LOAD_LOADED:"LOAD_LOADED"},qe=class{constructor(e){this.playOnInview=!0,this.el=e,this.video=this.el.parentElement,this.watcher=new C,this.watcher.add({element:window,on:"smartResize",callback:Re(this.onResize.bind(this),500)}),this.watcher.add({element:this.el,on:"force-lazy-load",callback:()=>{this.paint(!0)}});let t=this.el.getAttribute("lazy-video-forward-scalar");this.forwardLoadScalar=W(t)?+t:1,this.url=this.el.getAttribute("lazy-video")||"",this.setComplete=!1,this.playOnInview=!this.el.hasAttribute("lazy-video-disable-inview-play"),this.ev=_.inview(this.video,{rootMargin:window.innerHeight*this.forwardLoadScalar+"px"},()=>{this.paint()}),this.inviewEv=_.inview(this.video,{},()=>{this.paint()}),this.ev.readyPromise.then(()=>{this.paint()})}onResize(){this.setComplete||this.paint()}paint(e=!1){(this.isPainted()&&!this.setComplete||e)&&(this.setComplete=!0,this.el.setAttribute("src",this.url),Oe([this.video]).then(()=>{ae(this.video,Be.LOAD_LOADED,{}),this.playOnInview&&this.playVideo()}),this.video.load(),this.video.setAttribute("load","true"),this.video.pause(),ae(this.video,Be.LOAD_START,{}),this.dispose()),this.setComplete&&this.playOnInview&&(!this.isPainted()&&!this.inviewEv.state().inview?(this.video.currentTime=0,this.video.pause()):this.playVideo())}playVideo(){Z(this.video)||this.video.play().then(()=>{}).catch()}isPainted(){return!ce(this.video)&&this.ev.state().inview}dispose(){this.ev.dispose(),this.watcher.dispose()}},ue=class{constructor(e){this.lazyVideos=[],Array.from(e.querySelectorAll("[lazy-video]")).forEach(i=>{this.lazyVideos.push(new qe(i))})}dispose(){this.lazyVideos&&this.lazyVideos.forEach(e=>{e.dispose()})}};function de(r,...e){let t=null,i=Number.NEGATIVE_INFINITY,n=e[0];return r.forEach(s=>{let a=n(s);if(i<a)t=s,i=a;else if(i===a&&e.length>1){let o=1,l=e[o];for(;o<e.length&&l(t)===l(s);)l=e[o++];l(t)<l(s)&&(t=s)}}),t}function K(r,...e){return de(r,...e.map(t=>i=>-1*t(i)))}function He(r,e,t,i=1){let n=[],s=r.length,a=Math.sign(i),o=T(t,0,s),l=T(e,0,s);for(;l!==o;)n.push(r[l]),l=T(l+a,0,s);return n}function Fe(r){let e=window.location.search.split(r+"=")[1];return e=e&&e.split("&")[0],e||null}var ee;(function(u){u.MQN_DEBUGGER="mqnDebugger",u.MQN_GLOBAL_DEBUG="mqnGlobalDebug",u.SITE_MAX_WIDTH="siteMaxWidth",u.MQN_GRID="mqnGrid",u.MQN_GRID2="grid",u.MQN_GOOGLE_ONE_USER="mqnGoogleOneUser",u.MQN_CONCIERGE_USER="mqnConciergeUser",u.MQN_ANALYTICS="MQN_DEBUG_ANALYTICS",u.MQN_DEBUG_LEVEL="MQN_DEBUG_LEVEL",u.MQN_HIGHLIGHT_ATTRIBUTE="mqnHighlightAttribute",u.MQN_INSPECT_A11Y="mqnInspectAccessibility",u.MQN_IS_SUBSCRIBED="mqnIsSubscribed",u.MQN_SHOW_SECURITY_POLICY_VIOLATIONS="mqnShowSecurityPolicyViolations"})(ee||(ee={}));var E;(function(s){s[s.NONE=0]="NONE",s[s.MQN_CONTROLLER=1]="MQN_CONTROLLER",s[s.MQN_SMOOTH_SCROLL=2]="MQN_SMOOTH_SCROLL",s[s.MQN_MODULE=3]="MQN_MODULE",s[s.ALL=4]="ALL"})(E||(E={}));var Ge=class{constructor(){this.debugLevel=4;let e=Fe(ee.MQN_DEBUG_LEVEL);e&&E[e]?this.setDebugLevel(E[e]):this.setDebugLevel(0)}setDebugLevel(e){this.debugLevel=e}log(e,...t){if(this.debugLevel!=0){if(this.debugLevel==4){var t=Array.prototype.slice.call(arguments);console.log(...t)}if(e==this.debugLevel){var t=Array.prototype.slice.call(arguments);console.log(...t)}}}printCurrentDebugLevel(){console.log(this.debugLevel)}},ri=new Ge;function Ue(...r){}var B=class extends Map{constructor(e=[],t=Ue){super(e);this.defaultFunction=t}static usingFunction(e){return new this([],e)}get(e){if(this.has(e))return super.get(e);{let t=this.defaultFunction(e);return this.set(e,t),t}}};var M=class{constructor(){this.callbacks=B.usingFunction(()=>new Set)}on(e,t){this.callbacks.get(e).add(t)}dispatch(e,...t){this.callbacks.get(e).forEach(i=>i(...t))}off(e,t){let i=this.callbacks.get(e);i.delete(t),i.size===0&&this.callbacks.delete(e)}dispose(){let e=this.callbacks.values(),t=e.next();for(;!t.done;)t.value.clear(),t=e.next();this.callbacks.clear()}};var I=class{static splitMethodCall(e){let t=e.startsWith("!")||null;t&&(e=e.substring(1));let i=e.trim().split(/\.(.+)/),n=i[0];i[1]||console.log("Could not parse invalid expression: "+e);let s=i[1].split("(")[0],a=null,o=null;i[1].includes("(")?a=s:o=s;let l=null;if(a)try{l=i[1].match(/\(.*\)/g)[0],l=l.substring(1).slice(0,-1),l?l.startsWith("'[")&&l.endsWith("]'")||l.startsWith("'{")&&l.endsWith("}'")?l=[l.substring(1).slice(0,-1)]:(e.includes(",")?l=l.match(/('[^']+'|[^,]+)/g):l=[l],l=l.map((c,d)=>(c.includes("[")?c=JSON.parse(c):(c=c.trim(),c=c.replace(/\'/g,"")),c))):l=[]}catch(c){console.error("Lex Error: Failed interpreting expression.   Make sure this is a valid expression: ",e),console.error(c)}return{hasNot:!!t,controllerName:n,propertyName:o,methodName:a,methodValue:l}}static stripWhiteSpace(e){return e=e.replace(/\:\s/g,":").replace(/\s\:/g,":").trim(),e}};var he;(function(e){e.STATE_CHANGE="stateChange"})(he||(he={}));var N=class{constructor(e,t){this.el=e,this.name=t,this.watcher=new window.MqnLib.DomWatcher,this.readWrite=new window.MqnLib.Raf,this.eventManager=new M,window.MqnLib.debug.log(E.MQN_CONTROLLER,"Creating controller",this.name,this.el),this.makeAccessible(),this.setupDataOnWatchers(),this.setupEventBindings(),this.setupSwipeWatchers()}stateChange(){this.updateDataClassStates(),this.updateAttributeBinding(),this.eventManager.dispatch(he.STATE_CHANGE)}on(e,t){this.eventManager.on(e,t)}off(e,t){this.eventManager.off(e,t)}makeAccessible(){Array.from(this.el.querySelectorAll("[data-click]")).forEach(t=>{t.hasAttribute("data-click-disable-auto-a11y")||(t.setAttribute("role","button"),t.setAttribute("tabindex","0"))})}updateAttributeBinding(){let e=Array.from(this.el.querySelectorAll("[data-attribute]"));this.el.dataset.attribute&&e.push(this.el),e.forEach(t=>{let i=t.dataset.attribute.trim();i=I.stripWhiteSpace(i),i.substring(1).slice(0,-1);let n=i.match(/:'[1-90a-zA-Z,.!]+\([^)]+\)'|:'[a-zA-Z,.\(\)]+/g);n=n.map(o=>(o.endsWith("'")&&(o=o.slice(0,-1)),o.substring(2)));let s=i.match(/\'[1-90a-zA-Z\_\-Z]+\':/g);s=s.map(o=>o.replace(/'/g,"").replace(/"/g,"").replace(/:/g,""));let a={};try{s.forEach((o,l)=>{a[o]=n[l]})}catch(o){console.error("Something went wrong parsing data-bind attribute. Make sure it is not malformed.  Expressions should be strings and all method values should be strings."),console.log(i)}Object.keys(a).forEach(o=>{let l=a[o],c=I.splitMethodCall(l),d=c.controllerName,h=c.methodName,f=c.methodValue,u=c.propertyName,x=c.hasNot;if(d!==this.name)return;let g="";if(h){if(this[h]==null){console.error("No method named: "+h+" available in "+this.name);return}g=this[h].apply(this,f)}else{if(this[u]==null){console.error("No property named: "+u+" available in "+this.name);return}g=this[u]}if(g!=null){x&&Ee(g)&&(g=!g);let F=g+"";t.setAttribute(o,F),o==="aria-hidden"&&N.handleAriaHiddenChange(t,F)}})})}static handleAriaHiddenChange(e,t){t.toLowerCase()==="true"?le(e,-1):(ke(e),Array.from(e.querySelectorAll('[aria-hidden="true"]')).forEach(n=>le(n,-1)))}updateDataClassStates(){let e=Array.from(this.el.querySelectorAll("[data-class]"));this.el.dataset.class&&e.push(this.el),e.forEach(t=>{let i=t.dataset.class;i=I.stripWhiteSpace(i),i.substring(1).slice(0,-1);let n=i.match(/:'[1-90a-zA-Z,.!]+\([^)]+\)'|:'[a-zA-Z,.\(\)]+/g);n=n.map(o=>(o.endsWith("'")&&(o=o.slice(0,-1)),o.substring(2)));let s=i.match(/\'[1-90a-zA\_\-Z]+\':/g);s=s.map(o=>o.replace(/'/g,"").replace(/"/g,"").replace(/:/g,""));let a={};try{s.forEach((o,l)=>{a[o]=n[l]})}catch(o){console.error("Something went wrong parsing data-class attribute. Make sure it is not malformed.  Expressions should be strings and all method values should be strings."),console.log(i)}Object.keys(a).forEach(o=>{let l=a[o],c=I.splitMethodCall(l),d=c.controllerName,h=c.methodName,f=c.methodValue,u=c.propertyName,x=c.hasNot;if(d!==this.name)return;let g=!1;if(h){if(this[h]==null){console.error("No method named: "+h+" available in "+this.name);return}g=this[h].apply(this,f),x&&(g=!g)}else{if(this[u]==null){console.error("No property named: "+u+" available in "+this.name);return}g=this[u],x&&(g=!g)}g?t.classList.add(o):t.classList.remove(o)})})}setupDataOnWatchers(){Array.from(this.el.querySelectorAll("[data-on]")).forEach(t=>{if(!t.hasAttribute("data-on-event"))return;let i=t.getAttribute("data-on-event").trim(),n=t.getAttribute("data-on"),s=I.splitMethodCall(n),a=s.controllerName,o=s.methodName,l=s.propertyName,c=s.methodValue,d=s.hasNot;a===this.name&&o&&a==this.name&&this[o]!==void 0&&this.watcher.add({element:t,on:i,callback:()=>{this[o].apply(this,c)}})})}setupEventBindings(){let e=Array.from(this.el.querySelectorAll("[data-click], [data-mouseenter], [data-mouseleave], [data-mousedown], [data-mouseup], [data-mouseover], [data-mouseout]")),t=(i,n,s,a=!1)=>{let o=s.getAttribute(i);if(!o)return;let l=I.splitMethodCall(o),c=l.controllerName,d=l.methodName,h=l.methodValue;if(c===this.name&&d&&c==this.name&&this[d]!==void 0){let f={};a&&(f.capture=!0),this.watcher.add({element:s,on:n,callback:()=>{this[d].apply(this,h)},eventOptions:f}),(n=="click"||n=="mousedown"||n=="mouseup")&&this.watcher.add({element:s,on:"keydown",callback:u=>{(u.code==="Space"||u.code==="Enter")&&this[d].apply(this,h)}})}};e.forEach(i=>{t("data-click","click",i),t("data-mousedown","mousedown",i),t("data-mouseup","mouseup",i),t("data-mouseenter","mouseenter",i),t("data-mouseleave","mouseleave",i),t("data-mouseover","mouseover",i),t("data-mouseout","mouseout",i),t("data-focus","focus",i,!0),t("data-blur","blur",i,!0)})}setupSwipeWatchers(){let e=Array.from(this.el.querySelectorAll("[data-swipe-left], [data-swipe-right], [data-swipe-up], [data-swipe-down]")),t=(i,n)=>{let s=n.getAttribute(i);if(!s)return;let a=I.splitMethodCall(s),o=a.controllerName,l=a.methodName,c=a.methodValue;if(o===this.name&&l&&o==this.name&&this[l]!==void 0){let d,h,f=!1,u=!1,x=300,g=w=>{d=w.touches&&w.touches[0].clientX||w.x,h=w.touches&&w.touches[0].clientY||w.y,u=!0},F=w=>{u=!1},we=w=>{if(!d||!h||f||!u)return;let it=w.touches&&w.touches[0].clientX||w.x,nt=w.touches&&w.touches[0].clientY||w.y,se=it-d,re=nt-h;f=Math.abs(se)+Math.abs(re)>0,!!f&&(Math.abs(se)>Math.abs(re)?se>0?i=="data-swipe-left"&&this[l].apply(this,c):i=="data-swipe-right"&&this[l].apply(this,c):re>0?i=="data-swipe-up"&&this[l].apply(this,c):i=="data-swipe-down"&&this[l].apply(this,c),window.setTimeout(()=>{f=!1,u=!1},x))};this.watcher.add({element:n,on:"touchstart",eventOptions:{passive:!0},callback:g}),this.watcher.add({element:n,on:"touchend",eventOptions:{passive:!0},callback:F}),this.watcher.add({element:n,on:"touchmove",eventOptions:{passive:!0},callback:we}),this.watcher.add({element:n,on:"mousedown",eventOptions:{passive:!0},callback:g}),this.watcher.add({element:n,on:"mouseup",eventOptions:{passive:!0},callback:F}),this.watcher.add({element:n,on:"mousemove",eventOptions:{passive:!0},callback:we})}};e.forEach(i=>{t("data-swipe-left",i),t("data-swipe-right",i),t("data-swipe-up",i),t("data-swipe-down",i)})}getElement(){return this.el}dispose(){this.watcher.dispose()}};function Ve(...r){let e=new Set;return r.forEach(t=>{t.forEach(i=>{e.add(i)})}),e}var O=class{constructor(e){this.isReadWriteOnly=!1,this.callbacks=[],this.isDisposed=!1,this.raf_=null,this.frame=null,this.lastUpdateTime=0,this.fps=0,this.currentFps=0,this.isPlaying=!1,this.isRunningRaf=!1,this.callbacks=[],this.runCondition=null,this.delta=0,this.elaspedTime=0,this.startTime=0,e?this.watch(e):this.isReadWriteOnly=!0,window.DEGU_RAF_REGISTRY&&window.DEGU_RAF_REGISTRY.register(this)}watch(e){this.callbacks.push(e)}setReadWriteMode(e){this.isReadWriteOnly=e}preRead(e){window.DEGU_RAF_REGISTRY&&window.DEGU_RAF_REGISTRY.addOneTimePreRead({callback:e,raf:this})}read(e){window.DEGU_RAF_REGISTRY&&window.DEGU_RAF_REGISTRY.addOneTimeRead({callback:e,raf:this})}write(e){window.DEGU_RAF_REGISTRY&&window.DEGU_RAF_REGISTRY.addOneTimeWrite({callback:e,raf:this})}postWrite(e){window.DEGU_RAF_REGISTRY&&window.DEGU_RAF_REGISTRY.addOneTimePostWrite({callback:e,raf:this})}unwatch(e){this.callbacks=this.callbacks.filter(t=>t===e)}runWhen(e){this.runCondition=e}runWhenElementIsInview(e,t){return this.ev&&this.ev.dispose(),this.runCondition=null,this.ev=_.inview(e,t||{}),this.runWhen(()=>this.ev&&this.ev.state().inview),this.ev.readyPromise}setFps(e){this.fps=e}start(e=!1){!e&&this.isPlaying||(this.startTime=(typeof performance=="undefined"?Date:performance).now(),this.animationLoop_(),this.isPlaying=!0)}stop(){this.isPlaying=!1,window.cancelAnimationFrame(this.raf_),this.isRunningRaf=!1}dispose(){this.ev&&this.ev.dispose(),this.callbacks=[],this.isDisposed=!0,this.stop(),window.DEGU_RAF_REGISTRY&&window.DEGU_RAF_REGISTRY.unregister(this)}getDelta(e){return e?this.delta/1e3:this.delta}getElapsedTime(){return this.elaspedTime}getStartTime(){return this.startTime}getCurrentFps(){return this.currentFps}animationLoop_(){if(!this.isRunningRaf){if(this.raf_=window.requestAnimationFrame(e=>{this.frame=e,this.isRunningRaf=!1,this.animationLoop_()}),this.isRunningRaf=!0,this.lastUpdateTime){let t=Date.now()-this.lastUpdateTime;this.delta=t,this.elaspedTime+=t/1e3;let i=this.fps===0?0:1e3/this.fps;this.currentFps=1e3/t,t>i&&(this.callbacks&&this.callbacks.forEach(n=>{let s=()=>{n(this.frame,this.lastUpdateTime,t,()=>{this.stop()})};this.runCondition?this.runCondition()&&s():s()}),this.lastUpdateTime=Date.now())}this.lastUpdateTime||(this.lastUpdateTime=Date.now())}}},P=class{constructor(){this.flushScheduled=!1,this.preReads=[],this.reads=[],this.writes=[],this.postWrites=[],this.rafs=[]}static runRafCallbacks(e){for(;e.length;){let t=e.splice(0,1)[0];!t.raf.isDisposed&&(t.raf.isPlaying||t.raf.isReadWriteOnly)&&t.callback()}}start(){this.flushScheduled||(this.flushScheduled=!0,requestAnimationFrame(()=>{this.runRaf()}))}runRaf(){window.DEGU_RAF_REGISTRY_DEBUG&&console.log("Running raf",this.reads.length,this.writes.length),P.runRafCallbacks(this.preReads),P.runRafCallbacks(this.reads),P.runRafCallbacks(this.writes),P.runRafCallbacks(this.postWrites),this.flushScheduled=!1,(this.preReads.length||this.reads.length||this.writes.length||this.postWrites.length)&&this.start()}addOneTimePreRead(e){this.preReads.push(e),this.start()}addOneTimeRead(e){this.reads.push(e),this.start()}addOneTimeWrite(e){this.writes.push(e),this.start()}addOneTimePostWrite(e){this.postWrites.push(e),this.start()}getActiveRafCount(){return this.rafs.filter(e=>e.isPlaying).length}getRafCount(){return this.rafs.length}register(e){this.rafs.push(e)}unregister(e){this.rafs=this.rafs.filter(t=>t===e)}};window&&!window.DEGU_RAF_REGISTRY&&(window.DEGU_RAF_REGISTRY=new P);var p=class{constructor(e=0,t=0,i=0,n=0){this.x=e||0,this.y=t||0,this.z=i||0,this.w=n||0}clone(){return new p(this.x,this.y,this.z)}static clone(e){return new p(e.x,e.y,e.z)}set(e,t,i=0){return this.x=e,this.y=t,this.z=i,this}floor(){return this.x=~~this.x,this.y=~~this.y,this.z=~~this.z,this}int(){return this.x=this.x>>0,this.y=this.y>>0,this.z=this.z>>0,this}equals(e){return this.x===e.x&&this.y===e.y&&this.z===e.z}static equals(e,t){return e.x===t.x&&e.y===t.y&&e.z===t.z}toArray(){return[this.x,this.y,this.z]}static toArray(e){return[e.x,e.y,e.z]}static fromArray(e){return new p(e[0],e[1],e[2])}static create(e,t,i=0){return new p(e,t,i)}static fromAngle(e,t=1e5){return new p(t*Math.cos(e),t*Math.sin(e),0)}static angle2d(e,t){let i=e.x-t.x,n=e.y-t.y;return Math.atan2(n,i)}static getXyzRotationTo(e,t){let i=e.clone().subtract(t),n=Math.atan(i.x),s=Math.atan(i.y),a=Math.atan(i.z);return[n,s,a]}static getEularRotationTo(e,t){let i=e.clone().normalize().subtract(t.clone().normalize()),n=-Math.atan(i.x),s=Math.atan(i.y),a=-Math.atan(i.z);return new p(L(n),L(s),L(a))}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z||0,this}static add(e,t){let i=e.x+t.x,n=e.y+t.y,s=e.z+t.z;return new p(i,n,s)}subtract(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z||0,this}static subtract(e,t){let i=e.x-t.x,n=e.y-t.y,s=e.z-t.z;return new p(i,n,s)}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z||1,this}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z||1,this}scale(e){return isFinite(e)?(this.x*=e,this.y*=e,this.z*=e,this):p.ZERO}negate(){return this.x=-this.x,this.y=-this.y,this.z=X(-this.z),this}static negate(e){let t=-e.x,i=-e.y,n=X(-e.z);return new p(t,i,n)}distance(e){let t=e.x-this.x,i=e.y-this.y,n=e.z-this.z||0;return Math.sqrt(t*t+i*i+n*n)}length(){let e=this.x,t=this.y,i=this.z;return Math.sqrt(e*e+t*t+i*i)}lengthSquared(){return this.x*this.x+this.y*this.y+this.z*this.z}magnitude(){return this.length()}normalize(){let e=this.x,t=this.y,i=this.z,n=e*e+t*t+i*i;return n>0&&(n=1/Math.sqrt(n),this.x=e*n,this.y=t*n,this.z=i*n),this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}cross(e){let t=this.x,i=this.y,n=this.z,s=e.x,a=e.y,o=e.z;return this.x=i*o-n*a,this.y=n*s-t*o,this.z=t*a-i*s,this}transformWithMatrixIV(e){let t=this.x,i=this.y,n=this.z,s=e.value,a=t*s[0]+i*s[4]+n*s[8]+s[12],o=t*s[1]+i*s[5]+n*s[9]+s[13],l=t*s[2]+i*s[6]+n*s[10]+s[14],c=t*s[3]+i*s[7]+n*s[11]+s[15];return c=c||1,this.x=a/c,this.y=o/c,this.z=l/c,new p(this.x,this.y,this.z)}transformWithMatrixIVTo2d(e){return this.transformWithMatrixIV(e).set(this.x,this.y,0)}lerp(e,t=0){return this.x=v(this.x,e.x,t),this.y=v(this.y,e.y,t),this.z=v(this.z,e.z,t),this}damp(e,t=0,i){return this.x=J(this.x,e.x,t,i),this.y=J(this.y,e.y,t,i),this.z=J(this.z,e.z,t,i),this}ease(e,t=0,i=z){return this.x=R(this.x,e.x,t,i),this.y=R(this.y,e.y,t,i),this.z=R(this.z,e.z,t,i),this}static ease(e,t,i=0,n=z){let s=R(e.x,t.x,i,n),a=R(e.y,t.y,i,n),o=R(e.z,t.z,i,n);return new p(s,a,o)}static min(e,t){return new p(Math.min(e.x,t.x),Math.min(e.y,t.y),Math.min(e.z,t.z))}static max(e,t){return new p(Math.max(e.x,t.x),Math.max(e.y,t.y),Math.max(e.z,t.z))}static degreeToRadians(e){return new p(Q(e.x),Q(e.y),Q(e.z))}degreeToRadians(){return p.degreeToRadians(this)}static clamp(e,t,i){return new p(y(e.x,t.x,i.x),y(e.y,t.y,i.y),y(e.z,t.z,i.z))}static fromRotationMatrixIV(e){let t=p.ZERO,i=e.value,n=i[0],s=i[4],a=i[8],o=i[1],l=i[5],c=i[9],d=i[2],h=i[6],f=i[10];return t.y=Math.asin(y(-1,1,a)),Math.abs(a)<.9999999?(t.x=Math.atan2(-c,f),t.z=Math.atan2(-s,n)):(t.x=Math.atan2(h,l),t.z=0),t.x=L(t.x),t.y=L(t.y),t.z=L(t.z),t}static get ZERO(){return new p(0,0,0)}static get ONE(){return new p(1,1,1)}static get RIGHT(){return new p(1,0,0)}static get LEFT(){return new p(-1,0,0)}static get UP(){return new p(0,-1,0)}static get DOWN(){return new p(0,1,0)}static get FORWARD(){return new p(0,0,1)}static get BACK(){return new p(0,0,-1)}};var ct=["mousemove","touchstart","touchmove"],q;(function(r){r.UPDATE="update"})(q||(q={}));var m=class{constructor(){m.uses.size===0&&(m.raf=new O(()=>m.loop()),m.clientPosition=p.ZERO,m.nextClientPosition=p.ZERO,m.domWatcher=new C,m.eventManager=new M,ct.forEach(e=>{m.domWatcher.add({element:window,on:e,eventOptions:{passive:!0},callback:t=>m.updatePosition(t)})}),m.raf.start()),m.uses.add(this)}static updatePosition(e){e instanceof MouseEvent?this.updatePositionFromEvent(e):e instanceof TouchEvent&&this.updatePositionFromTouchEvent(e)}static updatePositionFromTouchEvent(e){e.touches.length>0&&this.updatePositionFromEvent(e.touches[0])}static updatePositionFromEvent(e){this.nextClientPosition=new p(e.clientX,e.clientY)}static loop(){this.raf.preRead(()=>{var e;this.nextClientPosition&&((e=this.clientPosition)===null||e===void 0?void 0:e.equals(this.nextClientPosition))||(this.clientPosition=this.nextClientPosition,this.eventManager.dispatch(q.UPDATE))})}on(e,t){m.eventManager.on(e,t)}off(e,t){m.eventManager.off(e,t)}getClientPosition(){return m.clientPosition}dispose(){m.uses.delete(this),m.uses.size===0&&(m.domWatcher.dispose(),m.raf.dispose(),m.clientPosition=null,m.eventManager.dispose())}};m.uses=new Set;var D=class{constructor(e,t,i,n){this.x2=e,this.y2=t,this.x3=e,this.y3=n}static getBezierPoint(e,t,i,n,s,a,o,l,c){let d=1-e,h=e*e*e*l+3*e*e*d*a+3*e*d*d*n+d*d*d*t,f=e*e*e*c+3*e*e*d*o+3*e*d*d*s+d*d*d*i;return{x:h,y:f}}static getPoint(e,t,i,n,s){return D.getBezierPoint(e,t.x,t.y,i.x,i.y,n.x,n.y,s.x,s.y)}static interpolateProgress(e,t,i,n,s){return D.getBezierPoint(e,0,0,t,i,n,s,1,1).y}interpolate(e){return D.interpolateProgress(e,this.x2,this.y2,this.x3,this.y3)}easingFunction(){return e=>this.interpolate(e)}static makeEasingFunction(e,t,i,n){return s=>this.interpolateProgress(s,e,t,i,n)}static makeEasingFunctionFromString(e){let t=e.split(",");return D.makeEasingFunction(+t[0],+t[1],+t[2],+t[3])}};var U;(function(r){r[r.LEFT=-1]="LEFT",r[r.RIGHT=1]="RIGHT"})(U||(U={}));var $e=class{constructor(e,t,i){this.target=e,this.timeRange=t,this.startDistance=i}},je=class{constructor(e,t){this.startX=e,this.startTime=t,this.lastMouseX=e}};function Ye(r){let e=Pe(r).transform;return!e.length||e==="none"?0:parseFloat(e.slice(7,-1).split(",")[4])}var S=class{constructor({transitionTime:e=500,easingFunction:t=S.DEFAULT_EASING}={}){this.raf=new O(()=>this.onRaf()),this.domWatcher=new C,this.easingFunction=t,this.transitionTime=e,this.transitionTarget=null,this.resizeTimeout=null,this.mouseTracker=new m,this.interaction=null,this.xTranslate=B.usingFunction(i=>Ye(i)),this.lastXTranslate=B.usingFunction(()=>null),this.startInteractionCallback=()=>this.startInteractionOnMouseUpdate()}static sumWidth(e){return De(e.map(t=>t.offsetWidth))}init(e){this.initResizeHandler(),this.carousel=e,this.raf.read(()=>this.transition(e.getFirstSlide(),0)),this.initDraggableSlides(),this.raf.start()}onRaf(){this.carousel.isDisabled()||this.raf.read(()=>{!this.isInteracting()&&this.transitionTarget?this.renderTransition():(this.isInteracting()&&this.renderInteraction(),this.loopSlides()),this.applyXTranslations()})}transition(e,t=null){if(this.transitionTarget!==null&&this.transitionTarget.target===e)return;let i=t===null?this.transitionTime:t,n=performance.now(),s=[n,n+i],a=this.getDistanceToCenter(e);this.transitionTarget=new $e(e,s,a)}getActiveSlide(){return K(this.carousel.getSlides(),e=>Math.abs(this.getDistanceBetween(e,this.carousel.container)),e=>-1*this.carousel.getIndex(e))}hasTransitionedTo(e){return this.getDistanceToCenter(e)===0}isInteracting(){return this.interaction!==null}dispose(){this.resizeTimeout&&window.clearTimeout(this.resizeTimeout),this.mouseTracker.dispose(),this.domWatcher.dispose(),this.xTranslate.clear(),this.lastXTranslate.clear()}initResizeHandler(){this.domWatcher.add({element:window,on:"resize",eventOptions:{passive:!0},callback:()=>{this.resizeTimeout&&window.clearTimeout(this.resizeTimeout),this.resizeTimeout=window.setTimeout(()=>this.transition(this.carousel.getActiveSlide(),0))}})}constrainXTranslations(){if(this.carousel.loop)return;let e=this.carousel.getSlides(),t=this.carousel.container.offsetWidth/2,i=S.sumWidth(e),s=e.slice(-1)[0].offsetWidth/2,a=e[0].offsetWidth/2,o=t-i+s,l=t-a;e.forEach(c=>{let d=this.xTranslate.get(c);this.xTranslate.set(c,y(o,l,d))})}applyXTranslations(){this.constrainXTranslations(),this.raf.write(()=>{this.xTranslate.forEach((e,t)=>{this.lastXTranslate.get(t)!==e&&(t.style.transform=`translateX(${e}px)`,this.lastXTranslate.set(t,e))})})}renderInteraction(){let e=this.getMouseX(),t=e-this.interaction.lastMouseX;this.interaction.lastMouseX=e,this.carousel.getSlides().forEach(i=>{this.translate(i,t)})}getDistanceToCenter(e){return this.getDistanceBetween(e,this.carousel.container)}initDraggableSlides(){this.carousel.getSlides().forEach(e=>{["touchstart","mousedown"].forEach(t=>{this.domWatcher.add({element:e,on:t,eventOptions:{passive:!0},callback:()=>this.startInteraction()})}),["contextmenu","dragstart","touchend","mouseup"].forEach(t=>{this.domWatcher.add({element:window,on:t,eventOptions:{passive:!0},callback:()=>this.endInteraction()})})})}getEasedTransitionPercent(){let e=Me(this.transitionTarget.timeRange[0],this.transitionTarget.timeRange[1],performance.now());return this.easingFunction(e)}renderTransition(){let e=this.transitionTarget;if(!e)return;let t=this.getEasedTransitionPercent(),i=v(e.startDistance,0,t),n=this.getDistanceToCenter(e.target),s=Math.abs(i)-Math.abs(n),a=Math.sign(n),o=s*a;this.carousel.getSlides().forEach(l=>this.translate(l,o)),this.loopSlides(),t===1&&(this.transitionTarget=null)}translate(e,t){let i=Math.round((this.xTranslate.get(e)+t)*100)/100;this.xTranslate.set(e,i)}loopSlides(){if(!this.carousel.loop)return;let e=this.transitionTarget&&this.transitionTarget.target||this.carousel.getActiveSlide(),t=this.carousel.getIndex(e),i=this.carousel.getSlides(),n=new Set(i.filter(h=>h!==e)),s=e.getBoundingClientRect().left,a={area:Math.max(s,0),index:t,direction:U.LEFT},o=We().clientWidth,l=s+e.offsetWidth,c={area:Math.min(o,o-l),index:t,direction:U.RIGHT},d=[a,c];for(;n.size>0;){let h=de(d,g=>g.area);h.index+=h.direction;let f=i[T(h.index,0,i.length)];h.area-=f.offsetWidth;let x=this.getDesiredDistanceBetween(e,f,h.direction)-this.getDistanceBetween(f,e);x!==0&&this.translate(f,x),n.delete(f)}}startInteraction(){var e;this.isInteracting()||(e=this.mouseTracker)===null||e===void 0||e.on(q.UPDATE,this.startInteractionCallback)}startInteractionOnMouseUpdate(){this.cancelStartInteractionCallback(),this.interaction=new je(this.getMouseX(),performance.now()),this.transitionTarget=null,this.carousel.stopTransition()}cancelStartInteractionCallback(){var e;(e=this.mouseTracker)===null||e===void 0||e.off(q.UPDATE,this.startInteractionCallback)}endInteraction(){if(this.interaction===null){this.cancelStartInteractionCallback();return}let e=performance.now()-this.interaction.startTime,t=this.getActiveSlide(),i=this.getDistanceToCenter(t),n=this.getMouseX()-this.interaction.startX,s=e>700?n:0;this.interaction=null;let a=Math.sign(s),o=Math.sign(i)*-1,l=this.carousel.loop;i===0||o===a||s===0?this.carousel.goToSlide(t):a===U.RIGHT?l||t!==this.carousel.getFirstSlide()?this.carousel.prev():this.carousel.goToSlide(t):l||t!==this.carousel.getLastSlide()?this.carousel.next():this.carousel.goToSlide(t)}getMouseX(){return this.mouseTracker.getClientPosition().x}getCenter(e){let t=e.getBoundingClientRect(),i=t.left+t.width/2,n=this.xTranslate.get(e)-Ye(e);return i+n}getDistanceBetween(e,t=null){let i=this.getCenter(e);return t!==null?i-this.getCenter(t):i-document.children[0].clientWidth/2}getDesiredDistanceBetween(e,t,i){if(e===t)return 0;let n=this.getInBetweenSlides(e,t,i),s=S.sumWidth(n),a=t.offsetWidth/2,o=e.offsetWidth/2;return(a+s+o)*i}getInBetweenSlides(e,t,i){let n=this.carousel.getIndex(e),s=this.carousel.getIndex(t)-i;return n===s?[]:this.carousel.loop?He(this.carousel.getSlides(),s,n,-i):this.carousel.getSlides().slice(Math.min(n+1,s),Math.max(n,s+i))}};S.DEFAULT_EASING=new D(.445,.05,.55,.95).easingFunction();var te=class{init(e){this.activeSlide=e.getFirstSlide()}getActiveSlide(){if(!this.activeSlide)throw new Error("CssClassesOnly transition not initialized");return this.activeSlide}transition(e){this.activeSlide=e}hasTransitionedTo(e){return this.activeSlide===e}isInteracting(){return!1}dispose(){}};var ut="data-index",H;(function(r){r[r.LEFT=-1]="LEFT",r[r.RIGHT=1]="RIGHT"})(H||(H={}));var A;(function(r){r.BEFORE_CHANGE="beforeChange",r.AFTER_CHANGE="afterChange"})(A||(A={}));var V;(function(r){r.ACTIVE_SLIDE="active",r.BEFORE_SLIDE="before",r.AFTER_SLIDE="after"})(V||(V={}));var Xe=class{constructor(e,t){this.callback=e,this.delay=t,this.timePassed=0,this.timeout=setTimeout(e,t),this.lastStartTime=+new Date}isPaused(){return this.timeout===null}pause(){this.isPaused()||(this.timePassed+=+new Date-this.lastStartTime,this.clear())}unpause(){!this.isPaused()||(this.timeout=setTimeout(this.callback,this.delay-this.timePassed),this.lastStartTime=+new Date)}dispose(){this.clear()}clear(){this.timeout&&(clearTimeout(this.timeout),this.timeout=null)}},pe=class{constructor(e,t,{condition:i=()=>!0,activeCssClass:n=V.ACTIVE_SLIDE,beforeCssClass:s=V.BEFORE_SLIDE,afterCssClass:a=V.AFTER_SLIDE,distanceToActiveSlideAttr:o=ut,loop:l=!0,transition:c=void 0,autoplaySpeed:d=void 0}={}){if(t.length<1)throw new Error("Cannot start carousel without slides");if(this.raf=new O(()=>this.onRaf()),this.activeCssClass=n,this.beforeCssClass=s,this.afterCssClass=a,this.distanceToActiveSlideAttr=o,this.loop=l,this.condition=i,this.container=e,this.lastActiveSlide=null,this.eventManager=new M,this.slides=t,typeof c=="string")switch(c){case"css":this.transition=new te;break;case"draggable":this.transition=new S;break;default:throw new Error(`Unrecognized transition type "${c}" passed to Carousel.`)}else this.transition=c||new te;this.transitionTarget=null,this.autoplaySpeed=d,this.autoplayTimeout=null,this.syncedCarousels=new Set([this]),this.init()}isDisabled(){return!this.condition()}isEnabled(){return this.condition()}goTo(e,t=!1){typeof e=="number"?this.goToIndex(e,t):this.goToSlide(e,t)}goToSlide(e,t=!1){this.isBeingInteractedWith()||this.transitionTarget!==e&&(this.transitionTarget=e,this.eventManager.dispatch(A.BEFORE_CHANGE,{carousel:this,currentSlide:this.getActiveSlide(),currentIndex:this.getActiveIndex(),nextSlide:this.transitionTarget,nextIndex:this.getIndex(this.transitionTarget)}),t||this.syncedCarousels.forEach(i=>{i!==this&&i.syncTo(this.getIndex(e),this)}))}isBeingInteractedWith(){return this.transition.isInteracting()}getActiveSlide(){return this.transition.getActiveSlide()}getActiveIndex(){return this.getIndex(this.getActiveSlide())}getFirstSlide(){return this.slides[0]}getLastSlide(){return this.slides[this.slides.length-1]}getIndex(e){return this.getSlides().indexOf(e)}getSlides(){return[...this.slides]}getSlidesBefore(e){return this.loop?this.splitSlidesInHalf(e,H.LEFT):this.getSlides().slice(0,this.getSlides().indexOf(e))}getSlidesAfter(e){return this.loop?this.splitSlidesInHalf(e,H.RIGHT):this.getSlides().slice(this.getSlides().indexOf(e)+1)}next(){this.transitionSlidesBy(1)}prev(){this.transitionSlidesBy(-1)}goToIndex(e,t=!1){let i=this.getClampedIndex(e);this.goToSlide(this.getSlideByIndex(i),t)}on(e,t){this.eventManager.on(e,t)}off(e,t){this.eventManager.off(e,t)}getSlideByIndex(e){return this.slides[e]}getSlideCount(){return this.slides.length}dispose(){this.raf.dispose(),this.transition.dispose()}stopTransition(){this.transitionTarget=null}getClampedIndex(e){let t=this.getSlides().length;return this.loop?T(e,0,t):y(0,t-1,e)}sync(...e){let t=Ve(this.syncedCarousels,...e.map(i=>i.syncedCarousels));this.syncedCarousels=t,t.forEach(i=>i.syncedCarousels=t)}pause(){this.autoplayTimeout&&this.autoplayTimeout.pause()}unpause(){this.autoplayTimeout&&this.autoplayTimeout.unpause()}isPaused(){return this.autoplayTimeout===null||this.autoplayTimeout.isPaused()}transitionSlidesBy(e){let t=this.getSlides().indexOf(this.transitionTarget||this.getActiveSlide())+e;this.goToIndex(t)}syncTo(e,t){let i=e%this.getSlideCount();if(this.getIndex(this.transitionTarget)%t.getSlideCount()!==i)if(this.getSlideCount()>t.getSlideCount()){let s=[],a=i;for(;a<this.getSlideCount();)s.push(a),a+=t.getSlideCount();this.goTo(K(s,o=>Math.abs(this.getActiveIndex()-o)),!0)}else this.goTo(i,!0)}getHalfOfSlideCount(e){let t=(this.getSlides().length-1)/2;return t%2==0?t:e?Math.ceil(t):Math.floor(t)}splitSlidesInHalf(e,t){let i=this.getHalfOfSlideCount(t===H.RIGHT),n=[],s=this.getIndex(e);for(;n.length<i;){s=T(s+t,0,this.getSlideCount());let a=this.getSlideByIndex(s);t===H.RIGHT?n.push(a):n.unshift(a)}return n}init(){this.transition.init(this),this.raf.start(),this.resetAutoplayTimeout()}resetAutoplayTimeout(){this.autoplaySpeed&&(this.autoplayTimeout&&this.autoplayTimeout.dispose(),this.autoplayTimeout=new Xe(()=>this.next(),this.autoplaySpeed))}onRaf(){this.raf.read(()=>{if(this.condition())this.unpause();else{this.pause();return}this.isBeingInteractedWith()&&this.resetAutoplayTimeout();let e=this.getActiveSlide();e!==this.lastActiveSlide&&(this.lastActiveSlide=e,e&&this.updateClasses(e)),this.transitionTarget!==null&&(this.transition.hasTransitionedTo(this.transitionTarget)?(this.transitionTarget=null,this.eventManager.dispatch(A.AFTER_CHANGE,{carousel:this,currentSlide:this.getActiveSlide(),currentIndex:this.getActiveIndex()}),this.resetAutoplayTimeout()):this.transition.transition(this.transitionTarget))})}updateClasses(e){let t=this.getSlidesBefore(e),i=this.getSlidesAfter(e);this.raf.write(()=>{e.classList.add(this.activeCssClass),e.classList.remove(this.beforeCssClass,this.afterCssClass),e.setAttribute(this.distanceToActiveSlideAttr,"0"),t.reverse().forEach((n,s)=>{n.classList.add(this.beforeCssClass),n.classList.remove(this.activeCssClass,this.afterCssClass),n.setAttribute(this.distanceToActiveSlideAttr,`${-s-1}`)}),i.forEach((n,s)=>{n.classList.add(this.afterCssClass),n.classList.remove(this.activeCssClass,this.beforeCssClass),n.setAttribute(this.distanceToActiveSlideAttr,`${s+1}`)})})}};var $;(function(r){r.ANY_CHANGE="any",r.MOUSE="mouse",r.KEYBOARD="keyboard"})($||($={}));var dt=5e3,me=class extends N{constructor(e,t="carouselCtrl",i={}){super(e,t);this.lastSlideIndex=null;this.movedLeft=!1;this.paused=!1;this.carouselSlideDuration=dt;let n=i.slideSelector||"[slide]";this.slides=Array.from(this.el.querySelectorAll(n)),this.carousel=new pe(e,this.slides,{condition:()=>!i.condition||i.condition(),loop:typeof i.loop=="undefined"?!0:i.loop,autoplaySpeed:this.carouselSlideDuration}),this.carousel.on(A.BEFORE_CHANGE,s=>{s.currentIndex!==s.nextIndex&&(this.lastSlideIndex=s.currentIndex)}),this.carousel.on(A.AFTER_CHANGE,()=>{this.dotGroups.forEach(s=>{s.setActive(this.carousel.getActiveIndex())}),this.stateChange()}),this.dotGroups=Array.from(this.el.querySelectorAll("bento-dot-group")),this.setImagesAsNonDraggable(),this.goTo(0)}setImagesAsNonDraggable(){Array.from(this.el.querySelectorAll("img")).forEach(e=>{e.setAttribute("draggable","false")})}pauseOnKeyboardNavigation(){this.keyboardWatcher=window.MqnLib.keyboardWatcher,this.keyboardWatcher.on($.KEYBOARD,()=>{this.pause()}),this.keyboardWatcher.on($.MOUSE,()=>{this.unpause()})}setSlideDuration(e){this.carouselSlideDuration=e,this.carousel.autoplaySpeed!=null&&this.carousel.autoplaySpeed!=Number.POSITIVE_INFINITY&&(this.carousel.autoplaySpeed=e)}goTo(e,t=!1){this.carousel.goToIndex(+e),t&&window.MqnLib.analytics.trackCarouselNavigationClick(this.el,+e),this.carousel.getActiveSlide(),this.playAllVideosInElement(this.carousel.getActiveSlide(),!0),this.stateChange()}playAllVideosInElement(e,t=!1){Array.from(e.querySelectorAll("video[load=true]")).forEach(n=>{t&&(n.currentTime=0),Z(n)||n.play().then(()=>{}).catch()})}pauseAllVideosInElement(e,t=!1){Array.from(e.querySelectorAll("video[load=true]")).forEach(n=>{t&&(n.currentTime=0),n.pause()})}goToAndStop(e){this.stop(),this.goTo(e)}stop(){this.pause(`${this.carousel.getActiveIndex()}`),this.carousel.autoplaySpeed=null}isStopped(){return this.carousel.autoplaySpeed===null}goToAndPause(e){this.goTo(e);let t=()=>{window.setTimeout(()=>this.pause(),0),this.carousel.off(A.AFTER_CHANGE,t)};this.carousel.on(A.AFTER_CHANGE,t)}pause(e){this.isStopped()||W(e)&&+e!==this.carousel.getActiveIndex()||this.carousel.isPaused()&&this.paused||(this.paused=!0,this.carousel.pause(),this.dotGroups.forEach(t=>t.pause()),this.pauseAllVideosInElement(this.carousel.getActiveSlide()),this.stateChange())}unpause(e){this.isStopped()||W(e)&&+e!==this.carousel.getActiveIndex()||!this.carousel.isPaused()&&!this.paused||(this.paused=!1,this.carousel.unpause(),this.dotGroups.forEach(t=>t.unpause()),this.playAllVideosInElement(this.carousel.getActiveSlide(),!1),this.stateChange())}isPaused(){return this.carousel.isPaused()}nextSlide(e=!1){let t=this.carousel.getActiveIndex()+1;this.movedLeft=!1,this.goTo(t,e)}previousSlide(e=!1){let t=this.carousel.getActiveIndex()-1;this.movedLeft=!0,this.goTo(t,e)}hasMovedLeft(){return this.movedLeft}getCarouselSlideCount(){return this.carousel.getSlideCount()}getNavigationArialLabel(e,t,i){return e.replace(/\@1/g,t).replace(/\@2/g,i)}getPreviousAriaLabel(e){let t=this.carousel.getClampedIndex(this.getActiveIndex()-1)+1;return e.replace(/\@1/g,`${t}`).replace(/\@2/g,`${this.getCarouselSlideCount()}`)}getNextAriaLabel(e){let t=this.carousel.getClampedIndex(this.getActiveIndex()+1)+1;return e.replace(/\@1/g,`${t}`).replace(/\@2/g,`${this.getCarouselSlideCount()}`)}isActiveSlideDarkThemed(){let e=this.carousel.getActiveSlide();return e&&e.classList.contains("mqn-opt--dark-themed")}isIndexOneOf(...e){return!!e.find(t=>this.carousel.getActiveIndex()===+t)}isIndex(e){return this.carousel.getActiveIndex()===+e}isLastIndex(e){return this.lastSlideIndex===+e}isNotIndex(e){return this.carousel.getActiveIndex()!==+e}getActiveSlide(){return this.carousel.getActiveSlide()}getActiveIndex(){return this.carousel.getActiveIndex()}getSlides(){return this.carousel.getSlides()}dispose(){this.keyboardWatcher&&this.keyboardWatcher.dispose(),super.dispose()}};var fe={ENTER:"DOMContentLoaded",LOAD:"load",TRACKING_NAVIGATION:"trackingNavigationEvent",LEAVE:"mannequinImpendingNavigation"};var ge={test:{url:"http://google.com",label:"Google",source:null,imageUrl:null,behavior:"REDIRECT",pageId:null,skuId:"_test",productName:"Test",ariaLabel:"Test Aria Label"},test_disabled:{url:"http://google.com",label:"Google",source:null,imageUrl:null,behavior:"DISABLED",pageId:null,skuId:"_test",productName:"Test",ariaLabel:"Test Aria Label"},_google_pixel_stand_white:{url:null,label:"Unavailable",source:null,imageUrl:null,behavior:"DISABLED",pageId:null,skuId:"_google_pixel_stand_white",productName:"Google Pixel Stand White",ariaLabel:""},chromecast_google_tv:{url:"/config/chromecast_google_tv",label:"Buy",source:null,imageUrl:null,behavior:"REDIRECT",pageId:null,skuId:null,productName:"Chromecast with Google TV",ariaLabel:"Buy Chromecast with Google TV"},nest_audio:{url:"/config/nest_audio",label:"Buy",source:null,imageUrl:null,behavior:"REDIRECT",pageId:null,skuId:null,productName:"Nest Audio",ariaLabel:"Buy Nest Audio"},nest_thermostat:{url:"/config/nest_thermostat",label:"Buy",source:null,imageUrl:null,behavior:"REDIRECT",pageId:null,skuId:null,productName:"Nest Thermostat",ariaLabel:"Buy Nest Thermostat"},nest_thermostat_e:{url:null,label:"Buy",source:null,imageUrl:null,behavior:"REDIRECT",pageId:null,skuId:null,productName:"Nest Thermostat E",ariaLabel:""},pixel_4:{url:"/config/pixel_4",label:"Buy",source:null,imageUrl:null,behavior:"REDIRECT",pageId:null,skuId:null,productName:"Google Pixel 4",ariaLabel:"Buy Google Pixel 4"},pixel_4a_5g:{url:null,label:"No longer available",source:null,imageUrl:null,behavior:"DISABLED",pageId:null,skuId:null,productName:"Google Pixel 4a with 5G",ariaLabel:""},pixel_4a_5g_case_fabric:{url:"/config/pixel_4a_5g_case_fabric",label:"Buy",source:null,imageUrl:null,behavior:"REDIRECT",pageId:null,skuId:null,productName:"Google Pixel 4a (5G) Case",ariaLabel:"Buy Google Pixel 4a (5G) Case"},pixel_6:{ariaLabel:"Buy Pixel 6",behavior:"REDIRECT",imageUrl:null,label:"Buy",pageId:null,productName:"Pixel 6",skuId:null,source:null,url:"/config/pixel_6"},pixel_5:{url:null,label:"No longer available",source:null,imageUrl:null,behavior:"DISABLED",pageId:null,skuId:null,productName:"Google Pixel 5",ariaLabel:""},pixel_5_case_fabric:{url:"/config/pixel_5_case_fabric",label:"Buy",source:null,imageUrl:null,behavior:"REDIRECT",pageId:null,skuId:null,productName:"Google Pixel 5 Case",ariaLabel:"Buy Google Pixel 5 Case"},pixel_pass:{url:"#compare",label:"Subscribe ",source:null,imageUrl:null,behavior:"REDIRECT",pageId:null,skuId:null,productName:"Pixel Pass",ariaLabel:"Subscribe  Pixel Pass"},stadia:{url:"/product/gaming_entertainment_package",label:"Buy",source:null,imageUrl:null,behavior:"REDIRECT",pageId:null,skuId:null,productName:"Stadia Overview",ariaLabel:"Buy Stadia Overview"},usb_c_earbuds:{url:null,label:"Buy",source:null,imageUrl:null,behavior:"ADD_TO_CART",pageId:null,skuId:"_pixel_usb_c_earbuds_white",productName:"Google Pixel USB-C\u2122 earbuds",ariaLabel:"Add Google Pixel USB-C\u2122 earbuds to cart"}};var Qe={_pixel_usb_c_earbuds_white:new Promise(r=>r(void 0))};var Je={'[[{"docid":"_google_home_mini_chalk","quantity":1},{"docid":"_nest_learning_thermostat_3rd_gen","quantity":1}],"+"]':new Promise(r=>r({html:'<span class="jZS2Hf" data-test-is-price="">From CA$329</span>',financingHtml:"",priceInformation:{was_price:"",was_price_micros:0,current_price:"CA$329",current_price_micros:329e6,currency_code:"CAD",is_discounted:!1,discount_amount:"",is_free:!1,is_same_price:!1,is_eligible_for_epp_pixel_financing:!1,was_epp_per_month_price:"",epp_per_month_price:""},save:"",orMonthlyRateMessage:""})),'[[{"docid":"_google_home_mini_chalk","quantity":1},{"docid":"_nest_learning_thermostat_3rd_gen","quantity":1}],""]':new Promise(r=>r({html:'<span class="jZS2Hf" data-test-is-price="">From CA$329</span>',financingHtml:"",priceInformation:{was_price:"",was_price_micros:0,current_price:"CA$329",current_price_micros:329e6,currency_code:"CAD",is_discounted:!1,discount_amount:"",is_free:!1,is_same_price:!1,is_eligible_for_epp_pixel_financing:!1,was_epp_per_month_price:"",epp_per_month_price:""},save:"",orMonthlyRateMessage:""})),'[[{"docid":"_google_nest_hub_max_chalk","quantity":1},{"docid":"chromecast_google_tv","quantity":1}],"+"]':new Promise(r=>r({html:'<span class="BFggEc" data-test-discount-amount="">Save $60<sup>+</sup></span><span class="jZS2Hf" data-test-is-price="">From $169</span> <span class="h0uEUb" data-test-was-price="">$229</span>',financingHtml:'<div class="fAkyUe"><div class="DYUuAf"><span><span class="BFggEc">Save $60<sup>+</sup> </span>Pay $169 or $28.17/month</span></div><div class="obluzb"><span>with <b>6 months</b> special financing. </span></div></div>',priceInformation:{was_price:"$229",was_price_micros:229e6,current_price:"$169",current_price_micros:169e6,currency_code:"USD",is_discounted:!0,discount_amount:"$60",is_free:!1,is_same_price:!1,is_eligible_for_epp_pixel_financing:!1,was_epp_per_month_price:"$38.17",epp_per_month_price:"$28.17",epp_number_of_months:6},save:"Save $60",orMonthlyRateMessage:"or $28.17/month"})),'[[{"docid":"_google_nest_hub_max_chalk","quantity":1},{"docid":"chromecast_google_tv","quantity":1}],""]':new Promise(r=>r({html:'<span class="BFggEc" data-test-discount-amount="">Save $60</span><span class="jZS2Hf" data-test-is-price="">From $169</span> <span class="h0uEUb" data-test-was-price="">$229</span>',financingHtml:'<div class="fAkyUe"><div class="DYUuAf"><span><span class="BFggEc">Save $60 </span>Pay $169 or $28.17/month</span></div><div class="obluzb"><span>with <b>6 months</b> special financing. </span></div></div>',priceInformation:{was_price:"$229",was_price_micros:229e6,current_price:"$169",current_price_micros:169e6,currency_code:"USD",is_discounted:!0,discount_amount:"$60",is_free:!1,is_same_price:!1,is_eligible_for_epp_pixel_financing:!1,was_epp_per_month_price:"$38.17",epp_per_month_price:"$28.17",epp_number_of_months:6},save:"Save $60",orMonthlyRateMessage:"or $28.17/month"}))};var j=class{constructor(){this._subscribeUserSucceeds=!0;this.productCtaDataMap=new Map,document.addEventListener("populatePrices",()=>{document.querySelectorAll(".is-was-price-text").forEach(t=>{t.textContent="$XX"})})}static getMockProductCtaData(e){if(ge[e])return ge[e];throw new Error(`No mock Product Cta Data found for ${e}`)}static getMockResponse(e,t){let i=this.fnNameToMockResponse[e],n=JSON.stringify(t);if(!i[n]){let s=t.map(a=>JSON.stringify(a)).join(", ");throw console.log(`Arguments passed to mannequinService.${e}() where no mock response was found:`,...t),new Error(`No mock response is found for the call to mannequinService.${e}. Please run mannequinService.${e}(${s}).then((result) => console.log(JSON.stringify(result))); on gstore-internal.]
Copy the resulting string and put it in the appropriate mock response record for ${e} under the key: ${n}`)}return i[n]}getBundlePrice(e,t){return j.getMockResponse("getBundlePrice",[e,t])}setInnerHtml(e,t){console.warn("MockMannequinService does not properly implement setInnerHtml"),e.innerHTML=t}subscribeUser(e,t){return new Promise((i,n)=>{this._subscribeUserSucceeds?i():n()})}redirectToLogin(){throw new Error("redirectToLogin not implemented in MannequinService mock")}async safeLoad(e,t){throw new Error("safeLoad not implemented in MannequinService mock")}navigateToUrl(e){console.log(`Called mockMannequinService.navigateToUrl with ${e}`)}joinWaitlist(e,t){return new Promise(i=>{i({updatedBehavior:b.LEAVE_WAITLIST,updatedLabel:"Leave Waitlist"})})}leaveWaitlist(e){return new Promise(t=>{t({updatedBehavior:b.JOIN_WAITLIST,updatedLabel:"Join Waitlist"})})}addToCart(e){return j.getMockResponse("addToCart",[e])}fetchPostalCodeRebate(e){throw new Error("fetchPostalCodeRebate not implemented in MannequinService mock")}fetchProductCtaData(e){return e.forEach(t=>{this.productCtaDataMap.set(t,j.getMockProductCtaData(t))}),new Promise(t=>t(new Map(this.productCtaDataMap)))}},ie=j;ie.fnNameToMockResponse={addToCart:Qe,getBundlePrice:Je};var Ze=window.location.host.includes("google.com");var Ke;(function(s){s.UNKNOWN="UNKNOWN",s.NEST_AWARE="NEST_AWARE",s.CONCIERGE="CONCIERGE",s.PLATFORM="PLATFORM",s.BUNDLE="BUNDLE"})(Ke||(Ke={}));var b;(function(o){o.UNSPECIFIED="UNSPECIFIED",o.REDIRECT="REDIRECT",o.JOIN_WAITLIST="JOIN_WAITLIST",o.SIGN_IN_AND_JOIN_WAITLIST="SIGN_IN_AND_JOIN_WAITLIST",o.LEAVE_WAITLIST="LEAVE_WAITLIST",o.ADD_TO_CART="ADD_TO_CART",o.DISABLED="DISABLED"})(b||(b={}));var ht=new Promise(r=>{if(Ze){let e=()=>window.mannequinService?r(window.mannequinService):window.requestAnimationFrame(e);window.requestAnimationFrame(e)}else console.log("Using Mock Mannequin Service"),r(new ie)}),et=ht;var k;(function(i){i.DOC_ID="mqn-dynamic-cta-doc-id",i.READY="mqn-dynamic-cta-done",i.TEXT="text"})(k||(k={}));var pt="unspecified",Y=class{constructor(e,t){this.el=e,this.textEl=e.querySelector(`[${k.TEXT}]`),this.docId=t!==pt?t:Y.GetDocIdFromUrl(),this.domWatcher=new window.MqnLib.DomWatcher,this.init()}static GetDocIdFromUrl(){return window.location.href.split("/").slice(-1)[0].split("?")[0].split("#")[0]}async init(){this.mannequinService=await et;let e=i=>{if(this.data=i.get(this.docId),!this.data&&!window.MqnLib.mqnGlobal.isProd){console.error(`No data found for product w/ docID ${this.docId}`);return}this.el.removeAttribute("href"),this.updateFromData(),this.domWatcher.add({element:this.el,on:"click",callback:()=>this.handleClick()})},t=()=>{if(this.docId!==Y.GetDocIdFromUrl())return;let i=document.querySelector("#pdb button.transaction")||document.querySelector('button[data-test="cta"]');!i||(this.el.removeAttribute("href"),this.updateFromSniffedCta(i),this.domWatcher.add({element:this.el,on:"click",callback:()=>i.click()}))};this.mannequinService.fetchProductCtaData([this.docId]).then(e,t)}updateFromSniffedCta(e){this.textEl.innerText=e.innerText,this.el.setAttribute("aria-label",e.getAttribute("aria-label")),this.el.disabled=e.disabled,this.el.setAttribute(k.READY,"true")}updateFromData(){this.textEl.innerText=this.data.label,this.data.ariaLabel&&this.el.setAttribute("aria-label",this.data.ariaLabel),this.setDisabledState(),this.el.setAttribute(k.READY,"true")}setDisabledState(){switch(this.data.behavior){case`${b.REDIRECT}`:case`${b.JOIN_WAITLIST}`:case`${b.SIGN_IN_AND_JOIN_WAITLIST}`:case`${b.LEAVE_WAITLIST}`:case`${b.ADD_TO_CART}`:this.el.disabled=!1;break;case`${b.UNSPECIFIED}`:case`${b.DISABLED}`:default:this.el.disabled=!0;break}}handleClick(){if(this.data.behavior===`${b.REDIRECT}`)this.data.url&&this.mannequinService.navigateToUrl(this.data.url);else if(this.data.behavior===`${b.JOIN_WAITLIST}`)this.el.disabled=!0,this.mannequinService.joinWaitlist(this.docId,this.data.productName).then(e=>{this.data.ariaLabel=e.updatedLabel,this.data.behavior=b.LEAVE_WAITLIST,this.el.disabled=!1});else if(this.data.behavior===`${b.SIGN_IN_AND_JOIN_WAITLIST}`){let t=`https://accounts.google.com/ServiceLogin?ltmpl=googlestore&continue=${encodeURIComponent(location.href)}`;this.mannequinService.navigateToUrl(t)}else this.data.behavior===`${b.LEAVE_WAITLIST}`?(this.el.disabled=!0,this.mannequinService.leaveWaitlist(this.docId).then(e=>{this.data.ariaLabel=e.updatedLabel,this.data.behavior=b.JOIN_WAITLIST,this.el.disabled=!1})):this.data.behavior===`${b.ADD_TO_CART}`&&(this.el.disabled=!0,this.mannequinService.addToCart(this.data.skuId))}dispose(){this.domWatcher.dispose()}},be=class extends N{constructor(e){super(e,"dynamicCtaCtrl");this.ctas=Array.from(e.querySelectorAll(`[${k.DOC_ID}]`)).map(t=>new Y(t,t.getAttribute(k.DOC_ID)))}dispose(){super.dispose(),this.ctas.forEach(e=>e.dispose()),this.ctas=[]}};var xe=class{constructor(e){this.id=e,this.moduleElements=[],this.mqnServiceDynamicCtaControllers=[],this.init()}init(){this.watchPageEvents()}watchPageEvents(){document.addEventListener(fe.ENTER,this.handleDOMContentLoaded.bind(this)),document.addEventListener(fe.LEAVE,this.handleLeave.bind(this))}addBrowserNames(){this.moduleElements.forEach(e=>{window.MqnLib.appendBrowserNameToElement(e)})}handleDOMContentLoaded(){window.setTimeout(()=>{this.moduleElements=Array.from(document.querySelectorAll(`[mqn2-app-${this.id}]`)),this.moduleElements.length>=1&&(this.addBrowserNames(),this.mounted(),this.moduleElements.forEach(e=>{e.classList.add("ready"),this.setupDynamicCtas(),_.inview(e,{rootMargin:`${window.innerHeight*2}px 0px 0px 0px`},(t,i,n)=>{i.isIntersecting&&(ze(t),n())})}))})}mounted(){}handleLeave(){this.moduleElements.length>=1&&this.dispose(),this.moduleElements=[]}setupDynamicCtas(){this.mqnServiceDynamicCtaControllers=this.moduleElements.map(e=>new be(e))}disposeDynamicCtas(){this.mqnServiceDynamicCtaControllers.forEach(e=>{e.dispose()}),this.mqnServiceDynamicCtaControllers=[]}dispose(){this.disposeDynamicCtas()}};var ne;(function(e){e.DURATION="template-singlecolumn-carousel-slide-duration"})(ne||(ne={}));var tt=class extends xe{constructor(){super("template-singlecolumn-simple");this.controllers=[];this.lazyVideoManagers=[]}mounted(){this.moduleElements.forEach(e=>{Array.from(e.querySelectorAll("[carousel]")).forEach(t=>{let i=new me(t),n=e.querySelector(`[${ne.DURATION}]`),s=parseFloat(n.getAttribute(ne.DURATION)),a=isNaN(s)||s===0?5e3:s,o=Math.round(a*1e3);i.setSlideDuration(o),this.controllers.push(i)}),this.lazyVideoManagers.push(new ue(e))})}dispose(){this.lazyVideoManagers.forEach(e=>{e.dispose()}),this.lazyVideoManagers=[],this.controllers.forEach(e=>{e.dispose()}),this.controllers=[]}};new tt;})();
